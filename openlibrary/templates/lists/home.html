$def with ()

$var title: $_('Lists')

<div id="contentHead">
    <h1>$_('Lists')</h1>
</div>

<div id="contentBody">

    <div id="description" class="lists-page-cta">
      <h2>$_('Create a list of any Subjects, Authors, Works or specific Editions.')</h2>
      <p>$:_('Once you\'ve made a list, you can <strong>watch for updates</strong> or <strong>export</strong> all the editions in a list as HTML, BibTeX or JSON. See all your lists and any activity using the "Lists" link on your Account page.')
        <strong><em>$_('Enjoy!')</em></strong>
      </p>
      <p>$:_('For the top 2000+ most requested eBooks in California for the print disabled <a href="%(url)s">click here</a>.', url="../people/sionnac/lists/OL25152L")</p>

  <form class="siteSearch olform" action="/search/lists">
    <input type="text" class="larger" name="q" size="100" value=""
           placeholder="$_('Find a list by name')"/>
    <button type="submit" class="larger">$_('Search')</button>
  </form>
    </div>

    $ lists = get_active_lists_in_random(limit=24)
    <div class="head">
        <h2>$_('Active Lists')</h2>
    </div>
    <div class="lists">
    <!-- FOR EACH LIST -->
    $for list in lists:
        <div class="listEntry">
            <div class="data">
                <div class="name">
                    <a href="$list.key" class="title results">
                        <div class="cover">
                            $ cover = list.get_cover() or list.get_default_cover()
                            $ cover_url = cover and cover.url("S") or "/images/icons/avatar_book-sm.png"
                            <!-- Get the original width and height of cover image-->
                            $ cover_width = cover.width()
                            $ cover_height = cover.height()
                            <!-- Get the aspect ratio of cover image for resizing -->
                            $ cover_aspect_ratio = cover_width and cover_height and cover_width / cover_height
                            <!-- Calculate the width of cover image for 58px height (58px is the height of each cover image of size S) -->
                            $ cover_width_for_58px_height = cover_aspect_ratio and int(58 * cover_aspect_ratio)
                            <!-- Calculate the height of cover image for 25px width (25px is the width of each cover image in list view) -->
                            $ cover_height_for_25px_width = cover_width_for_58px_height and round(1450 / cover_width_for_58px_height)
                            <img src="$cover_url" alt="" width="25px" height="$cover_height_for_25px_width" />
                        </div>
                        $list.name
                    </a>
                    $ owner = list.get_owner()
                    $if owner:
                        $:_('from <a href="%(key)s">%(owner)s</a>', key=owner.key, owner=owner.displayname)
                </div>
                <div class="meta">
                    $ msg = ungettext("%(count)d item", "%(count)d items", len(list.seeds))
                    $sprintf(msg, count=len(list.seeds))
                    | $_('Last modified %(date)s', date=datestr(list.last_modified))
                </div>
                <div class="description no-img">
                $if list.description:
                    <p>$:reformat_html(format(list.description), max_length=250)</p>
                $else:
                    <p><em class="grey">$_('No description.')</em></p>
                </div>
            </div>
        </div>
    </div>
    <h2>
        $_('Recent Activity')
        <span class="tools"><a href="/recentchanges/lists">$_('See all')</a></span>
    </h2>
    $:render_template("lists/activity")

</div>
